import{V as C,r as o,a as q,j as e}from"./app-D_W3hKl1.js";import w from"./FrontMaster-BcUNaE0F.js";import{d as p}from"./index-DZ6zD-KU.js";import"./Footer-osmuTJyN.js";import"./Nav-DKNr4rQr.js";const $=()=>{const{products:m,message:S,coupons:h}=C().props,[a,g]=o.useState(m),[E,x]=o.useState(0),[c,j]=o.useState(null),{data:l,setData:i,post:v,errors:_,processing:d,patch:I}=q({cart:a,coupon_id:c});o.useEffect(()=>{if(a&&a.length>0){const t=a.reduce((s,r)=>s+r.price*r.quantity,0);x(t)}},[a]);const f=t=>{confirm("Are you sure you want to remove this item?")&&p.Inertia.delete(route("cart.destroy",t),{onSuccess:s=>{g(s.props.products),alert(s.props.message||"Item removed successfully!")},onError:s=>{alert("An error occurred while removing the item.")}})},y=(t,s)=>{s<1||(i("cart",l.cart.map(r=>r.id===t?{...r,quantity:s}:r)),p.Inertia.patch(route("cartd.update",t),{quantity:s}))},N=t=>{j(t.target.value),i("coupon_id",t.target.value)},b=t=>{t.preventDefault(),console.log(c),v(route("placeorders"),{data:{cart:a,coupon_id:c||null},onSuccess:()=>{alert("Order placed successfully!"),window.location.href="/myorders"},onError:()=>{alert("An error occurred while placing the order.")}})};return e.jsx(e.Fragment,{children:e.jsxs(w,{children:[e.jsx("div",{className:"bg-light",children:e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-12",children:e.jsx("img",{style:{height:"350px",width:"100%"},src:"/images/premium_photo-1706140675031-1e0548986ad1.jpeg",alt:"Cart Image",className:"img-fluid w-100"})})})}),a.length===0?e.jsxs("div",{className:"empty-cart",children:[e.jsx("p",{children:"Your cart is currently empty."}),e.jsx("button",{onClick:()=>window.location.href="/shop",children:"Return to shop"})]}):e.jsxs("div",{className:"container cart-products",children:[e.jsx("h3",{children:"Products in Your Cart"}),a.map(t=>{var s,r,u;return e.jsxs("div",{className:"product-item",children:[e.jsx("img",{src:`http://127.0.0.1:8000/images/product_image/${((r=(s=t.product.images)==null?void 0:s[0])==null?void 0:r.image)||"default-image.jpg"}`,alt:t.product.name,className:"img-fluid product-image"}),e.jsxs("div",{className:"product-details",children:[e.jsx("h5",{children:t.product.name}),e.jsxs("p",{children:["$",t.price]}),e.jsxs("div",{className:"quantity-section",children:[e.jsx("label",{htmlFor:`quantity-${t.id}`,className:"quantity-label",children:"Quantity:"}),e.jsx("input",{type:"number",id:`quantity-${t.id}`,min:"1",value:((u=l.cart.find(n=>n.id===t.id))==null?void 0:u.quantity)||1,onChange:n=>y(t.id,Number(n.target.value)),className:"quantity-input"})]})]}),e.jsx("div",{className:"product-actions",children:e.jsx("button",{onClick:()=>f(t.id),className:"btn btn-danger remove-btn",children:"Remove"})})]},t.id)}),e.jsxs("div",{className:"coupon-section",children:[e.jsx("label",{htmlFor:"coupon",className:"coupon-label",children:"Apply Coupon:"}),e.jsxs("select",{id:"coupon",value:c||"",onChange:N,className:"coupon-select",children:[e.jsx("option",{value:"",children:"Select Coupon"}),h.map(t=>e.jsxs("option",{value:t.id,children:[t.code," -"," ",t.discount_percentage,"% Off"]},t.id))]})]}),e.jsx("div",{className:"text-center",children:e.jsx("button",{onClick:b,className:"btn btn-success text-center w-25 m-auto",disabled:d,children:d?"Placing Order...":"Place Order"})})]})]})})};export{$ as default};
